import{A as c,a as d}from"./constants-rqNHC8Ty.js";import{a as u}from"./read-CWUqBtRO.js";import{h as l}from"./headers-B8g_0KXq.js";import{i as m}from"./navigation-BhUJQ3dQ.js";import{s as p}from"./logout-BT9Uwq4k.js";async function f(e,{title:r,body:t,tags:a,media:i}){const s=`${c}/${e}`,n={method:"PUT",headers:l(),body:JSON.stringify({title:r,body:t,tags:a,media:i})};try{const o=await fetch(s,n);if(!o.ok)throw new Error("Failed to update post");return await o.json()}catch(o){throw console.error("Error updating post:",o),o}}async function g(e){if(e.preventDefault(),!confirm("Confirm post update?"))return;const r=e.target,t=new FormData(r),a=new URLSearchParams(window.location.search).get("id"),i=t.get("media"),s=t.get("alt"),n={title:t.get("title"),body:t.get("body"),media:i?{url:i,alt:s}:null};try{await f(a,n)&&(window.location.href=`/post/?id=${a}`)}catch(o){console.error("Error updating post:",o)}}async function y(){d(),m(),p();const e=new URLSearchParams(window.location.search).get("id"),r=document.querySelector("#edit-post");if(!(!r||!e))try{const t=await u(e);document.querySelector("#title").value=t.title,document.querySelector("#post-body").value=t.body,t.media&&(document.querySelector("#image").value=t.media.url||"",document.querySelector("#image-alt").value=t.media.alt||""),t.tags&&(document.querySelector("#tags").value=t.tags.join(", ")),r.addEventListener("submit",g)}catch(t){console.error("Error loading post:",t)}}y();export{y as default};
