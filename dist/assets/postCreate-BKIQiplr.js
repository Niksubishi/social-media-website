import{h as d}from"./headers-B8g_0KXq.js";import{A as m,a as l}from"./constants-rqNHC8Ty.js";import{i as f}from"./navigation-BhUJQ3dQ.js";import{s as u}from"./logout-BT9Uwq4k.js";async function p({title:e,body:r,media:o,tags:s}){const n={method:"POST",headers:d(),body:JSON.stringify({title:e,body:r,media:o,tags:s})};try{const t=await fetch(m,n),i=await t.json();if(!t.ok)throw new Error(i.message||"Failed to create post");return i}catch(t){throw console.error("Detailed API Error:",t),t}}async function g(e){e.preventDefault();const r=e.target,o=new FormData(r),s=o.get("title").trim(),n=o.get("body").trim(),t=o.get("media").trim(),i=o.get("alt").trim();if(!s||!n){alert("Title and body are required fields.");return}const c={title:s,body:n,media:t?{url:t,alt:i}:void 0};try{const a=await p(c);if(a&&a.data.id)alert("Post created successfully!"),r.reset(),setTimeout(()=>{window.location.href="/"},2e3);else throw new Error("Invalid response format")}catch(a){console.error("Error creating post:",a),alert(`Error creating post: ${a.message}`)}}l();f();u();function h(){const e=document.querySelector("#create-post");e?e.addEventListener("submit",r=>{g(r)}):console.error("Form not found")}h();
