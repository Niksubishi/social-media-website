import{h as c,a as d}from"./headers-RPXbKLV3.js";import{a as l}from"./read-DRj3_9BT.js";import{A as u}from"./constants-Dyo2zk30.js";async function m(e,{title:r,body:t,tags:a,media:s}){const n=`${u}/${e}`,i={method:"PUT",headers:c(),body:JSON.stringify({title:r,body:t,tags:a,media:s})};try{const o=await fetch(n,i);if(!o.ok)throw new Error("Failed to update post");return await o.json()}catch(o){throw console.error("Error updating post:",o),o}}async function p(e){if(e.preventDefault(),!confirm("Confirm post update?"))return;const r=e.target,t=new FormData(r),a=new URLSearchParams(window.location.search).get("id"),s=t.get("media"),n=t.get("alt"),i={title:t.get("title"),body:t.get("body"),tags:t.get("tags")?t.get("tags").split(",").map(o=>o.trim()):[],media:s?{url:s,alt:n}:null};try{await m(a,i)&&(window.location.href=`/post/?id=${a}`)}catch(o){console.error("Error updating post:",o)}}async function f(){d();const e=new URLSearchParams(window.location.search).get("id"),r=document.querySelector("#edit-post");if(!(!r||!e))try{const t=await l(e);document.querySelector("#title").value=t.title,document.querySelector("#post-body").value=t.body,t.media&&(document.querySelector("#image").value=t.media.url||"",document.querySelector("#image-alt").value=t.media.alt||""),t.tags&&(document.querySelector("#tags").value=t.tags.join(", ")),r.addEventListener("submit",p)}catch(t){console.error("Error loading post:",t)}}f();export{f as default};
